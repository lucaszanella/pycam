FROM ubuntu:latest
MAINTAINER Lucas Zanella (me@lucaszanella.com)

ARG QT5_LINK=http://download.qt.io/official_releases/qt/5.9/5.9.1/qt-opensource-linux-x64-5.9.1.run
ARG QT5_HASH=1dc023a2129c5ac7c7bed7ca85cf4c25ff9fa3c83f88d1db202505ac23d4e413

RUN apt-get update \
    && apt-get install -y build-essential wget ca-certificates \
    python3 python3-dev libgl1-mesa-dev \
    qt5-default qml-module-qtquick-controls libqt5qml5 python3-pyqt5 \
    --no-install-recommends \
    && rm -rf /var/lib/apt/lists/*

COPY no-interaction.qs /home/project/no-interaction.qs

RUN apt-get -y install build-essential libgl1-mesa-dev libfontconfig1 libdbus-1-3 wget \
    && wget --progress=bar:force -O qt.run $QT5_LINK \
    && echo "$QT5_HASH qt.run" | sha256sum --quiet --check || ( echo 'Corrupt or malicious download' ; exit 1 ) \
    && chmod +x qt.run

RUN ./qt.run --script no-interaction.qs

WORKDIR /home/project

ENTRYPOINT "/bin/bash"
